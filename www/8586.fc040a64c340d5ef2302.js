(self.webpackChunkincidencias=self.webpackChunkincidencias||[]).push([[8586],{8586:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CameraWeb:()=>i,Camera:()=>c});var n=r(6304),a=r(5310),o=r(989);class i extends a.Uw{getPhoto(e){var t=this;return(0,n.Z)(function*(){return new Promise(function(){var r=(0,n.Z)(function*(r,a){if(e.webUseInput||e.source===o.oK.Photos)t.fileInputExperience(e,r);else if(e.source===o.oK.Prompt){let o=document.querySelector("pwa-action-sheet");o||(o=document.createElement("pwa-action-sheet"),document.body.appendChild(o)),o.header=e.promptLabelHeader||"Photo",o.cancelable=!1,o.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],o.addEventListener("onSelection",function(){var o=(0,n.Z)(function*(n){0===n.detail?t.fileInputExperience(e,r):t.cameraExperience(e,r,a)});return function(e){return o.apply(this,arguments)}}())}else t.cameraExperience(e,r,a)});return function(e,t){return r.apply(this,arguments)}}())})()}cameraExperience(e,t,r){var o=this;return(0,n.Z)(function*(){if(customElements.get("pwa-camera-modal")){const c=document.createElement("pwa-camera-modal");document.body.appendChild(c);try{yield c.componentOnReady(),c.addEventListener("onPhoto",function(){var i=(0,n.Z)(function*(n){const i=n.detail;null===i?r(new a.xz("User cancelled photos app")):i instanceof Error?r(i):t(yield o._getCameraPhoto(i,e)),c.dismiss(),document.body.removeChild(c)});return function(e){return i.apply(this,arguments)}}()),c.present()}catch(i){o.fileInputExperience(e,t)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/pwa-elements."),o.fileInputExperience(e,t)})()}fileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input");const n=()=>{var e;null===(e=r.parentNode)||void 0===e||e.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input",r.type="file",r.hidden=!0,document.body.appendChild(r),r.addEventListener("change",a=>{const o=r.files[0];let i="jpeg";if("image/png"===o.type?i="png":"image/gif"===o.type&&(i="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){const r=new FileReader;r.addEventListener("load",()=>{if("dataUrl"===e.resultType)t({dataUrl:r.result,format:i});else if("base64"===e.resultType){const e=r.result.split(",")[1];t({base64String:e,format:i})}n()}),r.readAsDataURL(o)}else t({webPath:URL.createObjectURL(o),format:i}),n()})),r.accept="image/*",r.capture=!0,e.source===o.oK.Photos||e.source===o.oK.Prompt?r.removeAttribute("capture"):e.direction===o.GW.Front?r.capture="user":e.direction===o.GW.Rear&&(r.capture="environment"),r.click()}_getCameraPhoto(e,t){return new Promise((r,n)=>{const a=new FileReader,o=e.type.split("/")[1];"uri"===t.resultType?r({webPath:URL.createObjectURL(e),format:o}):(a.readAsDataURL(e),a.onloadend=()=>{const e=a.result;r("dataUrl"===t.resultType?{dataUrl:e,format:o}:{base64String:e.split(",")[1],format:o})},a.onerror=e=>{n(e)})})}checkPermissions(){var e=this;return(0,n.Z)(function*(){if("undefined"==typeof navigator||!navigator.permissions)throw e.unavailable("Permissions API not available in this browser");try{return{camera:(yield window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch(t){throw e.unavailable("Camera permissions are not available in this browser")}})()}requestPermissions(){var e=this;return(0,n.Z)(function*(){throw e.unimplemented("Not implemented on web.")})()}}const c=new i}}]);